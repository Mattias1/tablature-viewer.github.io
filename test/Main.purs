module Test.Main where

import Prelude

import Data.Either (Either(..))
import Data.Foldable (length)
import Data.String.Utils (lines)
import Effect (Effect)
import Effect.Class.Console (log)
import TablatureParser (parseTabAst)
import Test.Assert (assert)
import Text.Parsing.StringParser (runParser)

main :: Effect Unit
main = do
  log "🍝"
  assert false
  -- testParse

testParse :: Effect Unit
testParse = case runParser parseTabAst testContent of
  Left _ -> assert false
  Right ast -> assert $ (length ast::Int) == length (lines testContent)
  where
  testContent = """
-------------------------------------------------------------------------------
                             Aftermath - Muse
-------------------------------------------------------------------------------
Tabbed by: Muser00
Tuning: Standard
 
[Intro] 0:39
 
e|--------------------------------------------------------------------------|
B|--------------------------------------------------------------------------|
G|------------------4b6r4p2-4~--------------------2h4/9-----------^7--------|
D|-----2h4-4----------------------------------------------------------------|
A|--s4----------------------------------------------------------------------|
E|--------------------------------------------------------------------------|
 
e|---------------------------------------------------------------------------|
B|---------------------------------------------------------------------------|
G|--^6b7r6p4\2-2—2h4p2-1----------------2-----2h4p2--------1-----1h2p1-------|
D|--------------------------------------4---4--------------2-----------2-----|
A|--------------------------------------4------------------2-----------------|
E|----------------------------------2-----------------2\0------0-------------|
 
e|---------------------------------------------------------------------------|
B|---------------------------------------------------------------------------|
G|------7-----7--7-----------------------------------------------------------|
D|------7-----7--7-----------12--12-----------14-----------------------------|
A|------9-----9--9-----------12--12-----------14-----------------------------|
E|--/7------7--------7--/10---------10/12-12---------------------------------|
 
e|----------------------------------------------+12--------------------------|
B|-----------2---2-----------------------------------------------------------|
G|-----2-----4b6-4-2h4p2-----------------------------------------------------|
D|-----4-----------------4p2-------------------------------------------------|
A|-----4---------------------------------------------------------------------|
E|--2------2-----------------------------------------------------------------|
 
e|---------------------------------------------------------------------------|
B|---------------------------------------------------------------------------|
G|------7-----7h9p7----------------7--7--------9-----------------------------|
D|------7-----7-----9p7-9p7--------7--7--------9-----------------------------|
A|------9-------------------9---/5-------5/7-7-------------------------------|
E|--/7------7----------------------------------------------------------------|
"""
